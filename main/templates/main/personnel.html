<div id="whole-content" style="display: none;">
{% extends 'main/index.html' %}
{% load static %}
{% block content %}


<div class="container-fluid">
    <div class="row">
        <div class="row">
            <div class="col-12">
                <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                    <h4 class="mb-sm-0">Resident Information</h4>
                </div>
            </div>
        </div>
        <!-- end page title -->

        <div class="card">
            <div class="card-body">
                <div class="row g-2">
                    <div class="col-lg-auto">
                        <div class="hstack gap-2">
                              <a href="{% url 'personnel_forms' %}" class="btn btn-primary">
                                <i class="ri-add-line align-bottom me-1"></i> Add Personnel
                              </a>
                              
                        </div>
                    </div>
                    <!--end col-->
                    <div class="col-lg-3 col-auto">
                        <div class="search-box">
                            <input type="text" class="form-control search" id="searchInput" placeholder="Search for Personnel">
                            <i class="ri-search-line search-icon"></i>
                        </div>
                    </div>
                   
                </div>
                <!--end row-->
            </div>
            <!--end card-body-->
    <div class="row h-100">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <table class="table table-striped display" style="width:100%" id="userList">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Position</th>    
                                <th style="width: 20%;">Action</th>
                            </tr>
                        </thead>
                        <tbody id="personnelTableBody">
                            
                        </tbody>
                    </table>
                       <!-- Pagination buttons -->
                <div class="d-flex justify-content-center">
                    <nav aria-label="Page navigation example">
                        <ul class="pagination">
                            <li class="page-item">
                                <a class="page-link" href="#" aria-label="Previous" onclick="loadPreviousPage()">
                                    <span aria-hidden="true">&laquo;</span>
                                </a>
                            </li>
                            <!-- You can dynamically generate page buttons here -->
                            <!-- For example, if you have 5 pages, you can create 5 buttons -->
                            <li class="page-item"><a class="page-link pagination-link" href="#" data-page="1">1</a></li>
                            <li class="page-item"><a class="page-link pagination-link" href="#" data-page="2">2</a></li>
                            <li class="page-item"><a class="page-link pagination-link" href="#" data-page="3">3</a></li>
                            <!-- Add more buttons as needed -->
                            <li class="page-item">
                                <a class="page-link" href="#" aria-label="Next" onclick="loadNextPage()">
                                    <span aria-hidden="true">&raquo;</span>
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>
                </div> <!-- end card-body-->
            </div>
        </div> <!-- end col-->
    </div> <!-- end row-->

    <!-- Pagination -->

    <!-- Edit Modal -->
    <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-modal="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editModalLabel">Officials Information</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form action="javascript:void(0);">
                        <div class="row g-4">
                               <!-- Image Container -->
                               <div class="col-12 text-center">
                                <div class="square-container">
                                    <img src="" alt="Preview Image" id="previewImage" class="img-fluid rounded" style="max-width: 100%; max-height: 100%;">
                                </div> 
                                <input type="file" id="photo_path">
                   
                        </div>
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                                <label for="firstname" class="form-label1">First Name <span>*</span></label>
                                <input type="text" class="form-control" id="first_name" placeholder="First Name">
                            </div>
                        </div>
                        <!--end col-->
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                                <label for="labelInput" class="form-label1">Middle Name</label>
                                <input type="text" class="form-control" id="middle_name" placeholder="Middle Name">
                            </div>
                        </div>
                        <!--end col-->
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                                <label for="lastname" class="form-label1">Last Name <span>*</span></label>
                                <input type="text" class="form-control" id="last_name" placeholder="Last Name">
                            </div>
                        </div>
                        <!--end col-->
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                                <label for="Suffix" class="form-label1">Suffix</label>
                                <div class="input-group">
                                    <select class="form-select" id="suffix">
                                        <option value="" disabled selected>Select a suffix</option>
                                        <option value="Sr.">Sr.</option>
                                        <option value="Jr.">Jr.</option>
                                        <option value="I">I</option>
                                        <option value="II">II</option>
                                        <option value="III">III</option>
                                    </select>
                                </div>
                            </div>
                        </div>
      
                                <div class="col-xxl-3 col-md-6">
                                    <div class="asterisk">
                                        <label for="exampleInputdate" class="form-label1">Birthday <span>*</span></label>
                                        <input type="date" class="form-control" id="birthday">
                                    </div>
                                </div>
                               
                              
                                <!--Phone number-->
                                <div class="col-xxl-3 col-md-6">
                                    <div class="asterisk">
                                        <label for="phone_no" class="form-label1">Phone Number <span>*</span></label>
                                        <div class="form-icon right">
                                            <input type="text" class="form-control form-control-icon" id="phone_no" placeholder="09*******" >
                                            <i class="ri-phone-line"></i>
                                    </div>
                                    </div>
                                </div>
                                <!--email-->
                                <div class="col-xxl-3 col-md-6">
                                    <div class="asterisk">
                                        <label for="email" class="form-label1">Email <span>*</span></label>
                                        <div class="form-icon right">
                                            <input type="email" class="form-control form-control-icon" id="email" placeholder="example@gmail.com" >
                                            <i class="ri-mail-unread-line"></i>
                                        </div>
                                    </div>
                                </div>
                                <!--Occupation-->
                                <div class="col-xxl-3 col-md-6">
                                    <div class="asterisk">
                                    <label for="Occupation" class="form-label">Position <span>*</span></label>
                                    <select class="form-select" id="position" required onchange="showAdditionalFieldsPosition()">
                                        <option value="" disabled selected>Select Position</option>
                                        <option value="Secretary">Secretary</option>
                                        <option value="Treasurer">Treasurer</option>
                                        <option value="Health Worker">Health Worker</option>
                                        <option value="Tanod">Tanod</option>
                                    </select>
                                    </div>
                                </div>
                                <!-- statrt term -->
                                <div class="col-xxl-3 col-md-6">
                                    <div class="asterisk">
                                        <label for="exampleInputdate" class="form-label1">Start Term <span>*</span></label>
                                        <input type="date" class="form-control" id="birthday">
                                    </div>
                                </div>
                                <!-- end term -->
                                <div class="col-xxl-3 col-md-6">
                                    <div class="asterisk">
                                        <label for="exampleInputdate" class="form-label1">End Term <span>*</span></label>
                                        <input type="date" class="form-control" id="birthday">
                                    </div>
                                </div>
                            <div class="col-lg-12">
                                <div class="hstack gap-2 justify-content-end">
                                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Close</button>
                                    <button type="submit" class="btn btn-primary">Submit</button>
                                </div>
                            </div><!--end col-->
                        </div><!--end row-->
                    </form>
                </div>
            </div>
        </div>
        <!-- end of modal edit -->
                          
<!--View Modal-->             

<div class="modal fade" id="viewModal" tabindex="-1" aria-labelledby="viewModalLabel" aria-modal="true">
    <div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="viewModalLabel">Personnel's Information</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <form action="javascript:void(0);">
                <div class="row g-4">
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                                <label for="Name" class="form-label1">Name</label>
                                
                            </div>
                        </div>
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                                <label for="age" class="form-label1">Age</label>
    
                            </div>
                        </div>
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                                <label for="exampleInputdate" class="form-label1">Birthday</label>
    
                            </div>
                        </div>
                         <!-- Birth order -->
                         <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                            <label for="birth_order" class="form-label1">Birth Order</label>
                            
                            </div>
                        </div>
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                                <label for="Birthplace" class="form-label1">Birthplace</label>
    
                            </div>
                        </div>
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                                <label for="blood_type" class="form-label1">Blood Type </label>
    
                            </div>
                        </div>
                        <!--end col-->
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                                <label for="gender" class="form-label1">Gender</label>
                              
                            </div>
                        </div>
                        <!--end col-->
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                            <label for="maritalStatus" class="form-label1">Civil Status</label>
                            
                        </div>
                        </div>
                        <!-- Address -->
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                                <label for="house_no" class="form-label1">Address </label>
    
                            </div>
                        </div>
                        
                        <!--Phone number-->
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                                <label for="phone_no" class="form-label1">Phone Number</label>
                                <div class="form-icon right">
                                   
                            </div>
                            </div>
                        </div>
                        <!--email-->
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                                <label for="email" class="form-label1">Email </label>
                                <div class="form-icon right">
    
                                </div>
                            </div>
                        </div>
                        <!--Occupation-->
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                            <label for="position" class="form-label1">Position</label>
                           
                            </div>
                        </div>
                       <!-- employed-->
                        <div id="additionalFieldsEmployed" style="display: none;">
                            <div class="row">
                                <div class="col-xxl-3 col-md-6 offset-md-3 offset-xxl-3">
                                    <label for="educationalattainment" class="form-label1">Educational Attainment </label>
    
                                </div>
    
                             </div>
                             </div>
                        <!-- indigenous -->
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                            <label for="indigenous" class="form-label1">Is Indigenous?</label>
                           
                            </div>
                        </div>
                         <!-- disability -->
                         <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                            <label for="disability" class="form-label1">Is Disability?</label>
                          
                            </div>
                        </div>
                     
                         <!-- Voter -->
                        <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                            <label for="voter" class="form-label1">Is Registered Voter?</label>
                            
                            </div>
                        </div>
                        <div id="RegisteredYes" style="display: none;">
                            <div class="row ">
                                <div class="col-xxl-3 col-md-6">
                                    <div class="asterisk">
                                    <label for="voting_precint" class="form-label1">Voting Precint</label>
                                   
                                </div>
                                </div>
                            </div>
                         </div>
                         <!-- Multiple Files Input Example -->
                         <div class="col-xxl-3 col-md-6">
                            <div class="asterisk">
                            <label for="formFileMultiple" class="form-label1">Valid ID </label>
    
                             </div>
                        </div>
    
                
                </div>
                    <!-- family bg -->
                                <div class="col-lg-12">
                                    <div class="card">
                                        <div class="card-header align-items-center d-flex justify-content-between">
                                            <h4 class="mb-sm-0">Mother's Information</h4>
                                        </div>
                                <!-- end card header -->
                                        <div class="card-body">
                                            <div class="live-preview">
                                                <div class="row gy-4">
                                                    <div class="col-xxl-3 col-md-6">
                                                        <div class="asterisk">
                                                            <label for="m_first_name" class="form-label1"> Mother's Name </label>
    
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-xxl-3 col-md-6">
                                                    <div class="asterisk">
                                                        <label for="Address" class="form-label1">Address</label>
    
                                                    </div>
                                                </div>
                                            <div class="col-xxl-3 col-md-6">
                                                <div class="asterisk">
                                                    <label for="exampleInputdate" class="form-label1">Birthday</label>
    
                                                </div>
                                            </div>
                                            <div class="col-xxl-3 col-md-6">
                                                <div class="asterisk">
                                                    <label for="gender" class="form-label1">Gender</label>
                                                    
                                                </div>
                                            </div>
                                            <div class="col-xxl-3 col-md-6">
                                                <div class="asterisk">
                                                    <label for="phonenum" class="form-label1">Phone Number </label>
                                                    <div class="form-icon right">
                                                        
                                                    </div>
                                                 </div>
                                                </div>
                                                <div class="col-xxl-3 col-md-6">
                                                    <div class="asterisk">
                                                        <label for="email" class="form-label1">Email </label>
                                                        <div class="form-icon right">
                                                           
                                                        </div>
                                                    </div>
                                                </div>
                                            
                                                
                                        </div>
                                        </div>
                                  </div>
                                 </div>
                                 </div>
    
                        <!-- Father's Information -->
                        <div class="col-lg-12">
                            <div class="card">
                                <div class="card-header align-items-center d-flex justify-content-between">
                                    <h4 class="mb-sm-0">Father's Information</h4>
                                </div>
                        <!-- end card header -->
                                <div class="card-body">
                                    <div class="live-preview">
                                        <div class="row gy-4">
                                            <div class="col-xxl-3 col-md-6">
                                                <div class="asterisk">
                                                    <label for="m_first_name" class="form-label1"> Mother's Name </label>
    
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-xxl-3 col-md-6">
                                            <div class="asterisk">
                                                <label for="Address" class="form-label1">Address</label>
    
                                            </div>
                                        </div>
                                    <div class="col-xxl-3 col-md-6">
                                        <div class="asterisk">
                                            <label for="exampleInputdate" class="form-label1">Birthday</label>
    
                                        </div>
                                    </div>
                                    <div class="col-xxl-3 col-md-6">
                                        <div class="asterisk">
                                            <label for="gender" class="form-label1">Gender</label>
                                            
                                        </div>
                                    </div>
                                    <div class="col-xxl-3 col-md-6">
                                        <div class="asterisk">
                                            <label for="phonenum" class="form-label1">Phone Number </label>
                                            <div class="form-icon right">
                                                
                                            </div>
                                         </div>
                                        </div>
                                        <div class="col-xxl-3 col-md-6">
                                            <div class="asterisk">
                                                <label for="email" class="form-label1">Email </label>
                                                <div class="form-icon right">
                                                   
                                                </div>
                                            </div>
                                        </div>
                                    
                                        
                                </div>
                                </div>
                          </div>
                         </div>
                         </div>
    
                  
                </div><!--end row-->
            
        </div>
    </div>
    </div>
    <!-- end of modal view -->
    </div>
</div>
</div>
</div> <!--div protection-->
<!-- container-fluid -->

{% block css %}
<link href="{% static 'css/profiles.css' %}" rel="stylesheet" type="text/css" />
{% endblock %}

{% block js %}

<script>
    $(document).ready(function () {
        // Function to load personnel data with pagination
        function loadPersonnels(page = 1, searchTerm = "") {
            $.ajax({
                url: "http://127.0.0.1:8000/personnels/getp?page=" + page + "&limit=10&search=" + encodeURIComponent(searchTerm),
                type: "GET",
                headers: {
                    "Authorization": "Bearer " + localStorage.getItem('token')
                },
                success: function (data) {
                    // Clear existing data
                    $("#personnelTableBody").empty();

                    // Check if personnels data is available
                    if (data.data.length > 0) {
                        // Iterate through personnels and append rows to the table
                        $.each(data.data, function (index, personnel) {
                            var row = '<tr>' +
                                '<td>' + personnel.first_name + ' ' + personnel.middle_name + ' ' + personnel.last_name + ' ' + personnel.suffix +'</td>' +
                                '<td>' + personnel.position + '</td>' +
                                '<td>' +
                                '<button class="btn btn-soft-secondary edit-btn" data-personnelid="' + personnel.id + '" type="button" data-bs-toggle="modal" data-bs-target="#editModal">' +
                                '<a href="#" class="dropdown-item"><i class="ri-pencil-fill align-bottom me-2 text-muted"></i> Edit</a>' +
                                '</button>' +
                                '<button class="btn btn-soft-success" data-personnelid="' + personnel.id + ' " type="button" data-bs-toggle="modal" aria-expanded="false" data-bs-target="#viewModal">' +
                                '<a href="#" class="dropdown-item"><i class="ri-eye-fill align-bottom me-2 text-muted"></i> View</a>' +
                                '</button>' +
                                '<button class="btn btn-soft-primary delete-btn" data-personnelid="' + personnel.id + '" type="button" aria-expanded="false">' +
                                '<a href="#" class="dropdown-item" onclick="event.preventDefault();"><i class="ri-delete-bin-fill align-bottom me-2 text-muted"></i> Delete</a>' +
                                '</button>' +
                                '</td>' +
                                '</tr>';

                            // Append the row to the table body
                            $("#personnelTableBody").append(row);
                        });
                    } else {
                        // Handle case when no personnels are found
                        $("#personnelTableBody").html('<tr><td colspan="5">No personnels found</td></tr>');
                    }
                },
                error: function () {
                    // Handle error case
                    console.error('Error fetching personnels data.');
                }
            });
        }
    // Search input change event handler
    $("#searchInput").on("input", function () {
            var searchTerm = $(this).val();
            loadPersonnels(1, searchTerm);
       });

    // Initial load of personnels data
            loadPersonnels();

    // Function to dynamically generate pagination buttons
    function generatePaginationButtons(totalPages) {
     var paginationContainer = $(".pagination");
     paginationContainer.empty();

    for (var i = 1; i <= totalPages; i++) {
    var button = '<li class="page-item"><a class="page-link pagination-link" href="#" data-page="' + i + '">' + i + '</a></li>';
    paginationContainer.append(button);
    }
}

    // Pagination click event handler
        $(document).on("click", ".pagination-link", function (event) {
            event.preventDefault();
            var page = $(this).attr("data-page");
            loadPersonnels(page);
        });

    // Variable to store the current page
            var currentPage = 1;

    // Function to load the next page
        function loadNextPage() {
            currentPage++;
            loadPersonnels(currentPage);
        }

    // Function to load the previous page
        function loadPreviousPage() {
            if (currentPage > 1) {
                currentPage--;
                loadPersonnels(currentPage);
            }
        }
   // DELETE MODAL POP UP ---------------------------------------------------------------
   $(document).on("click", ".delete-btn", function () {
            var personnelId = $(this).data("personnelid");
            // Display a confirmation prompt before proceeding with deletion
            if (confirm("Are you sure you want to delete this personnel?")) {
                // User clicked OK in the confirmation prompt
                // Call the function to delete the personnel with the given ID
                deletePersonnel(personnelId);
             }
        });

    // DELETE RESIDENT
        function deletePersonnel(personnelId) {
            $.ajax({
                 url: "http://127.0.0.1:8000/personnels/" + personnelId,
                type: "DELETE",
                headers: {
                    "Authorization": "Bearer " + localStorage.getItem('token')
                },
                success: function (data) {
                    // Reload the personnels after successful deletion
                    loadPersonnels();
                },
                 error: function () {
                    // Handle error case
                    console.error('Error deleting personnel.');
                }
            });
        }

    // FOR EDIT MODAL Attach a click event handler to the edit buttons--------------------------------------
        $(document).on("click", ".edit-btn", function () {
            var personnelId = $(this).data("personnelid");

            // Set the personnel ID to the modal data attribute
            $('#editModal').data('personnel-id', personnelId);

            // Call the function to get specific personnel data by ID
            getPersonnel(personnelId);
        });


    // Function to get specific personnel data by ID
        function getPersonnel(personnelId) {
            console.log('Getting personnel with ID:', personnelId);
            $.ajax({
                url: "http://127.0.0.1:8000/personnels/" + personnelId,
                type: "GET",
                headers: {
                    "Authorization": "Bearer " + localStorage.getItem('token')
                },
                success: function (data) {
                    // Populate the form fields with the personnel data
                    populateFormWithData(data.data);

                    // Open the modal for editing
                    $('#editModal').modal('show');
                },
                error: function (xhr, textStatus, errorThrown) {
                    // Handle error case
                    console.error('Error fetching personnel data:', textStatus, errorThrown);
                }
            });
        }

        // Function to populate form fields with personnel data
        function populateFormWithData(personnelData) {
            // Assuming you have form fields with corresponding IDs, update their values
            $('#first_name').val(personnelData.first_name);
            $('#middle_name').val(personnelData.middle_name);
            $('#last_name').val(personnelData.last_name);
            // Repeat this for other form fields
            $('#previewImage').attr('src', 'data:image/jpeg;base64,' + personnelData.photo_path);
        }

        // Attach a submit event handler to the form
        $(document).on("submit", "form", function (event) {
// Prevent the default form submission
event.preventDefault();

// Display a confirmation dialog
var isConfirmed = confirm("Are you sure you want to edit this personnel?");

// Check if the user confirmed the action
if (isConfirmed) {
    // Get the personnel ID from the form or any other source you have
    var personnelId = getPersonnelId(); // Implement the function to get the personnel ID

    console.log('Personnel ID:', personnelId); // Log the personnelId before making the request

    // Call the function to update personnel data by ID
    updatePersonnel(personnelId);
}
});

        // Function to update personnel data by ID
        function updatePersonnel(personnelId) {
            var personnelData = getFormData();
            console.log('Sending data to server:', personnelData);

            $.ajax({
                url: "http://127.0.0.1:8000/personnels/" + personnelId,
                type: "PUT",
                contentType: "application/json",
                data: JSON.stringify(personnelData),
                dataType: 'json',
                headers: {
                    "Authorization": "Bearer " + localStorage.getItem('token')
                },
                success: function (data) {
                    console.log("Personnel updated successfully");
                    // You might want to close the modal or perform other actions upon success
                },
                error: function (xhr, textStatus, errorThrown) {
                    console.error('Error updating personnel data:', textStatus, errorThrown);
                }
            });
        }

        // Function to gather form data into an object
        function getFormData() {
            // Create an object to store form data
            var personnelData = {
                first_name: $('#first_name').val(),
                middle_name: $('#middle_name').val(),
                last_name: $('#last_name').val(),
                photo_path: $('#previewImage')
                // Add other form fields here
            };

            // Return the object
            return personnelData;
        }

        // Function to get the personnel ID (you need to implement this based on your application logic)
        function getPersonnelId() {
            // Implement the logic to retrieve the personnel ID
            // For example, if you have stored the personnel ID in a data attribute of the form:
            return $('#editModal').data('personnel-id');
        }
    });

// VIEW MODAL----------------------------------------------------------------------------------
// Attach a click event handler to the view button
$(document).on("click", ".view-btn", function () {
    var personnelId = $(this).data("personnelid");

    // Call the function to get specific personnel data by ID
    getPersonnelForView(personnelId);
});

// Function to get specific personnel data by ID for the view modal
function getPersonnelForView(personnelId) {
    console.log('Getting personnel with ID for view:', personnelId);
    $.ajax({
        url: "http://127.0.0.1:8000/personnels/" + personnelId,
        type: "GET",
        headers: {
            "Authorization": "Bearer " + localStorage.getItem('token')
        },
        success: function (data) {
            // Populate the "Name" text in the view modal with personnel data
            updateViewModalName(data.data);
            // Open the view modal
            $('#viewModal').modal('show');
        },
        error: function (xhr, textStatus, errorThrown) {
            // Handle error case
            console.error('Error fetching personnel data for view:', textStatus, errorThrown);
        }
    });
}

// Function to update "Name" text in the view modal
function updateViewModalName(personnelData) {
    // Assuming you have an element with an ID for "Name" text in the view modal
    $('#viewModalName').text(personnelData.first_name + ' ' + personnel.middle_name + ' ' + personnelData.last_name);
    // You might want to add additional information here if needed
}


//SECURITY------------------------
   // Check for the token when the page loads
   document.addEventListener("DOMContentLoaded", function() {
         var token = localStorage.getItem('token');
         if (token) {
             // Show the services content if the token is present
             document.getElementById('whole-content').style.display = 'block';
         } else {
             // Redirect to login if token is not present
             window.location.href = "/login";  // Adjust the login page URL if necessary
         }
     });


 

</script>



{% endblock %}
{% endblock %}